<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <!-- Mirrored from 127.0.0.1:64444/Documentation/WeldAndJPARunningInTomcat by HTTrack Website Copier/3.x [XR&CO'2008], Wed, 01 Oct 2014 13:49:56 GMT -->
 <!-- Added by HTTrack -->
 <head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8">
  <!-- /Added by HTTrack -->  
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"> 
  <title>Seam Framework - Weld and JPA running in Tomcat</title> 
  <link class="component" href="../a4j/s/3_3_3.CR1org/richfaces/renderkit/html/css/basic_classes.xcss/DATB/eAELXT5DOhSIAQ%21sA18_.css" rel="stylesheet" type="text/css">
  <link class="component" href="../a4j/s/3_3_3.CR1org/richfaces/renderkit/html/css/extended_classes.xcss/DATB/eAELXT5DOhSIAQ%21sA18_.css" media="rich-extended-skinning" rel="stylesheet" type="text/css">
  <script src="../a4j/g/3_3_3.CR1org.ajax4jsf.javascript.AjaxScript" type="text/javascript"></script>
  <script type="text/javascript">window.RICH_FACES_EXTENDED_SKINNING_ON=true;</script>
  <script src="../a4j/g/3_3_3.CR1org/richfaces/renderkit/html/scripts/skinning.js" type="text/javascript"></script>
  <link href="../themes/sfwkorg/css/sfwk.css" rel="stylesheet" type="text/css"> 
  <link href="../themes/sfwkorg/css/shCore.css" rel="stylesheet" type="text/css"> 
  <link href="../themes/sfwkorg/css/shThemeDefault.css" rel="stylesheet" type="text/css"> 
  <script type="text/javascript" src="../seam/resource/remoting/resource/remote.js"></script> 
  <script type="text/javascript" src="../seam/resource/remoting/interface1535.js?httpSessionChecker"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/jquery.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/jqueryPlugins.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/lacewiki.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shCore.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushBash.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushCpp.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushCSharp.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushCss.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushDelphi.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushDiff.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushGroovy.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushJava.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushJScript.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushPhp.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushPlain.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushPython.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushRuby.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushScala.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushSql.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushVb.js"></script> 
  <script type="text/javascript" src="../themes/sfwkorg/js/sh/scripts/shBrushXml.js"></script> 
  <script type="text/javascript">
        /* If you really want to load the Flash garbage on every page, go ahead and enable this:
        SyntaxHighlighter.config.clipboardSwf = '/themes/sfwkorg/js/sh/scripts/clipboard.swf';
         */
        SyntaxHighlighter.defaults['gutter'] = false;
        SyntaxHighlighter.all();
	</script> 
  <script type="text/javascript">

        // ###################### Session timeout alert #################################

        var sessionChecker = Seam.Component.getInstance("httpSessionChecker");
        var timeoutURL = '/Home/JBossSeam';
        var timeoutMillis = '900'*1000+3000;
        var sessionTimeoutInterval = null;

        function startSessionTimeoutCheck() {
            sessionTimeoutInterval = setInterval('sessionChecker.isNewSession(alertTimeout)', timeoutMillis);
        }

        function stopSessionTimeoutCheck() {
            if (sessionTimeoutInterval) clearInterval(sessionTimeoutInterval);
        }

        function resetSessionTimeoutCheck() {
            if (sessionTimeoutInterval != null) {
                stopSessionTimeoutCheck();
                startSessionTimeoutCheck();
            }
        }

        function alertTimeout(newSession) {
            if (newSession) {
                clearInterval(sessionTimeoutInterval);
                jQuery(".ajaxSupport")
                        .removeAttr('onblur')
                        .removeAttr('onchange')
                        .removeAttr('onkeyup')
                        .removeAttr('onclick');
                jQuery(".sessionEventTrigger").hide();
                var answer = confirm("Your session has timed out, you will be redirected to the start page.");
                if (answer) window.location = timeoutURL;
            }
        }

        // ###################### Popups #################################

        var fadeInPopupDialog = function(hash) {
            hash.w.fadeIn('fast',function(){ hash.o.show(); });
            jQuery(".closeDialog", hash.w).attr("accesskey", "C"); // Dynamically assign accesskey to .closeDialog buttons
        };

        var fadeOutPopupDialog = function(hash) { hash.w.fadeOut('fast',function(){ hash.o.remove(); }); };

        // ###################### Tabbed Forms #################################

        var formTabErrors = {};

        function formTabRaiseError(tabId, fieldId, message) {

            formTabClearError(tabId, fieldId); // Clear error then re-add

            log("Raise error for tab: '" + tabId + "' field: " + fieldId);

            // Add an error message to the client message box
            log("Adding error message: " +tabId + fieldId + "ErrorMessage")
            jQuery("#clientMessageBoxTable").append(
                '<tr id="' + tabId + fieldId + 'ErrorMessage"><td><img src="/themes/sfwkorg/img/attention.gif" ' +
                'height="18" width="18" class="clientMessageBoxImage attentionImage"/></td>' +
                '<td><span id="attentionMessage" class="attentionMessage">'+ message + '</span></td></tr>'
            );
            if (formTabErrors[tabId] == null) {
                formTabErrors[tabId] = 1;
            } else {
                formTabErrors[tabId]++;
            }
            formTabRenderErrors(tabId);
        }

        function formTabClearError(tabId, fieldId) {
            if (document.getElementById(tabId+fieldId+"ErrorMessage") != null) { // This error is displayed
                log("Clear error for tab: '" + tabId + "' field: " + fieldId);
                log("Removing error message: " +tabId + fieldId + "ErrorMessage")
                // Remove the error message on the client message box
                jQuery("#"+tabId + fieldId + "ErrorMessage").remove();

                formTabErrors[tabId]--;
                formTabRenderErrors(tabId);
            }
        }

        function formTabRenderErrors(tabId) {
            log("Errors for tab: '" + tabId + "': " + formTabErrors[tabId]);

            if (formTabErrors[tabId] > 0 && document.getElementById(tabId+"InvalidIcon") == null) {
                log("Showing icon for tab: " + tabId);
                // Show an icon on the tab and blink it a few times
                jQuery("#"+tabId)
                    .prepend('<img id="' + tabId + 'InvalidIcon" ' +
                            'src="/themes/sfwkorg/img/attention.gif" width="13" height="13" ' +
                            'alt="!" style="vertical-align:bottom;margin-left:5px;margin-right:5px;"/>');
                pulsate("#"+tabId);
            } else if (formTabErrors[tabId] < 1){
                log("Removing icon of tab: " + tabId);
                jQuery("#"+tabId + "InvalidIcon").remove();             // Remove the error icon on the tab
            }

            var tabsHaveErrors = false;
            for (var tab in formTabErrors) {
                var numOfErrors = formTabErrors[tab];
                if (numOfErrors > 0) {
                    tabsHaveErrors = true;
                    break;
                }
            }

            if (tabsHaveErrors) {
                log("Hiding save button and showing form message box");
                jQuery(".saveButton").hide();                       // Hide save button(s)
                jQuery(".formControls").css("height", "30px");      // Adjust height for missing save button
                jQuery("#messageBoxContainer").hide();                 // Hide server messages
                jQuery("#clientMessageBoxContainer").show();           // Show client error messages
            } else {
                log("Showing save button and hiding form message box");
                jQuery(".saveButton").show();                       // Show save button(s)
                jQuery(".formControls").css("height", "");          // Readjust height for present save button
                jQuery("#clientMessageBoxContainer").hide();           // Hide client error messages
            }
        }

        function formTabClicked() {
            jQuery("#messageBoxContainer").hide();                 // Hide server messages
        }

        function log(message) {
            return; // Remove to enable logging
            if (!log.window_ || log.window_.closed) {
                var win = window.open("", null, "width=400,height=200," +
                                                "scrollbars=yes,resizable=yes,status=no," +
                                                "location=no,menubar=no,toolbar=no");
                if (!win) return;
                var doc = win.document;
                doc.write("<html><head><title>Debug Log</title></head><body style='font-family: monospace'></body></html>");
                doc.close();
                log.window_ = win;
            }
            var logLine = log.window_.document.createElement("div");
            logLine.appendChild(log.window_.document.createTextNode(message));
            log.window_.document.body.appendChild(logLine);
        }

        // ###################### Design #################################

        function highlightStars(item, range, end) {
            for (i = 1; i <= range; i++) {
                styleClass = ".item"+item+"-rate"+i;
                jQuery(styleClass).attr("src", "../themes/sfwkorg/img/star_grey.gif");
            }
            for (i = 1; i <= end; i++) {
                styleClass = ".item"+item+"-rate"+i;
                jQuery(styleClass).attr("src", "../themes/sfwkorg/img/star.gif");
            }
        }

        function pulsate(query) {
            var blinkCount = 2*2;
            do {
                jQuery(query)['fade'+(blinkCount%2==0?'Out':'In')]('fast');
            } while (--blinkCount);
        }

        function clearDocumentBackground() {
            // Noop for this skin
        }

        // Wrap boxes with border and shadow
        function wrapBoxes() {
            // Noop for this skin
        }

        function initPage() {
            checkCookieSupport();
            wrapBoxes();
        }

        jQuery(function() {
            initPage();
        });

    </script> 
  <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-25106513-1']);
        _gaq.push(['_trackPageview']);

        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();

    </script> 
 </head> 
 <body> 
  <noscript> 
   <div class="cookieJavaScriptWarning">
     Please activate JavaScript in your browser. Without it, you will only be able to browse this website but clicking on any advanced feature (any forms or submit buttons) will not work. 
   </div> 
  </noscript>
  <div id="dialogHelp" class="popupDialog">
   <span id="dialogHelpPopup" title="dialogHelp"></span>
   <span id="dialogHelpInit"> <script type="text/javascript">
            function showHelpPopup(width, height, offsetId) {
                var offset = jQuery("#"+offsetId).offset();
                jsf('dialogHelpPopup')
                    .css({width: width+"px", height: height+"px", top: offset.top-100+"px", left: offset.left-150+"px"})
                    .jqm({
                        closeClass: "closeDialog",
                        overlay: 0
                    });

                jQuery("#dialogHelpContent").css("width", width-20+"px").css("height", height-75+"px");
                jQuery("#dialogHelpContent").css("overflow", "auto");

                jsf('dialogHelpPopup').jqmShow();
            }
        </script></span> 
   <script type="text/javascript">jQuery(function() {
        jsf('dialogHelpPopup').Resizable({
            minTop: 1,
            dragHandle: "#dialogHelpHead",
            handlers: { se: "#dialogHelpResizeHandle" }
        });
    });</script> 
   <div class="popupDialogHead" id="dialogHelpHead">
    Help
   </div>
   <div id="dialogHelpContent" class="popupDialogContent"></div>
   <div id="dialogHelpControls" class="popupDialogControls">
    <div id="j_id14" style="padding:5px;">
     <a href="#" class="buttonNonpersistent closeDialog"><span class="buttonLabel">Close Help</span></a>
    </div>
   </div>
  </div> 
  <div id="wrapper"> 
   <div id="header">  
    <div>
     <a href="http://seamframework.org/"><img src="../themes/sfwkorg/img/blank.gif" height="98" width="210"></a> 
    </div> 
   </div>
   <div id="body"> 
    <div id="container"> 
     <div id="leftColumn">
      <div id="mainMenu" xmlns="http://www.w3.org/1999/xhtml">
       <div id="j_id121" class="box">
        <div class="mainMenuContainer"> 
         <div class="mainMenuHeader"></div> 
         <div class="mainMenuBody">
          <div id="j_id125" class="level1">
           <span class="level1Marker level1MarkerDot">·</span>
           <span class="level1Marker level1MarkerGreaterThan">&gt;</span>
           <span class="level1Marker level1MarkerSlash">/</span>
           <span class="level1Marker level1MarkerSpace">&nbsp;</span>
           <a href="../Home.html" class="level1Link">Home</a>
          </div>
          <div id="j_id132" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="../Home/WhySeam.html" class="level2Link">Why Seam?</a>
          </div>
          <div id="j_id139" class="level1">
           <span class="level1Marker level1MarkerDot">·</span>
           <span class="level1Marker level1MarkerGreaterThan">&gt;</span>
           <span class="level1Marker level1MarkerSlash">/</span>
           <span class="level1Marker level1MarkerSpace">&nbsp;</span>
           <a href="../Seam2.html" class="level1Link">Seam 2</a>
          </div>
          <div id="j_id146" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="../Seam2/GettingStarted.html" class="level2Link">Getting Started</a>
          </div>
          <div id="j_id153" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="../Seam2/Downloads.html" class="level2Link">Downloads</a>
          </div>
          <div id="j_id160" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="../Seam2/Documentation.html" class="level2Link">Documentation</a>
          </div>
          <div id="j_id167" class="level1">
           <span class="level1Marker level1MarkerDot">·</span>
           <span class="level1Marker level1MarkerGreaterThan">&gt;</span>
           <span class="level1Marker level1MarkerSlash">/</span>
           <span class="level1Marker level1MarkerSpace">&nbsp;</span>
           <a href="http://weld.cdi-spec.org/" class="level1Link">Weld</a>
          </div>
          <div id="j_id174" class="level1">
           <span class="level1Marker level1MarkerDot">·</span>
           <span class="level1Marker level1MarkerGreaterThan">&gt;</span>
           <span class="level1Marker level1MarkerSlash">/</span>
           <span class="level1Marker level1MarkerSpace">&nbsp;</span>
           <a href="../Community.html" class="level1Link">Community</a>
          </div>
          <div id="j_id181" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="https://community.jboss.org/" class="level2Link">Forums</a>
          </div>
          <div id="j_id188" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="../Community/CDIExtensions.html" class="level2Link">CDI Extensions</a>
          </div>
          <div id="j_id195" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="../Community/Contribute.html" class="level2Link">Contribute</a>
          </div>
          <div id="j_id202" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="../Community/JIRA.html" class="level2Link">JIRA</a>
          </div>
          <div id="j_id209" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="../Community/MailingLists.html" class="level2Link">Mailing Lists</a>
          </div>
          <div id="j_id216" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="../Community/Events.html" class="level2Link">Events</a>
          </div>
          <div id="j_id223" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="../Community/Links.html" class="level2Link">Links</a>
          </div>
          <div id="j_id230" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="../Community/SeamInProduction.html" class="level2Link">Seam In Production</a>
          </div>
          <div id="j_id237" class="level1">
           <span class="level1Marker level1MarkerDot">·</span>
           <span class="level1Marker level1MarkerGreaterThan">&gt;</span>
           <span class="level1Marker level1MarkerSlash">/</span>
           <span class="level1Marker level1MarkerSpace">&nbsp;</span>
           <a href="../Documentation.html" class="level1Link">Documentation</a>
          </div>
          <div id="j_id244" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="FAQs.html" class="level2Link">FAQs</a>
          </div>
          <div id="j_id251" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="KnowledgeBase.html" class="level2Link">Knowledge Base</a>
          </div>
          <div id="j_id258" class="level2">
           <span class="level2Marker level2MarkerDot">·</span>
           <span class="level2Marker level2MarkerGreaterThan">&gt;</span>
           <span class="level2Marker level2MarkerSlash">/</span>
           <span class="level2Marker level2MarkerSpace">&nbsp;</span>
           <a href="Design.html" class="level2Link">Design</a>
          </div> 
         </div> 
         <div class="mainMenuFooter"></div> 
        </div>
       </div> 
      </div> 
      <br> 
      <div style="margin-top: 25px; margin-left: 15px; margin-right: 15px; "> 
       <h2>Built with Seam</h2> 
       <p> You can find the full source code for this website in the <a href="/Download.html">Seam package</a> in the directory /examples/wiki. It is licensed under the LGPL. </p> 
       <div style="text-align:center;">
        <a href="/Community/GetASeamIcon.html"><img src="../themes/sfwkorg/img/runningon_seamlogo_beige.gif" height="50" width="200"></a> 
       </div> 
      </div> 
     </div> 
     <div id="rightColumn">
      <img src="../themes/sfwkorg/img/blank.gif" height="8" width="1">
      <div id="breadcrumb" class="breadcrumb">
       <span class="breadcrumbPanel"><a href="../index.html" class="itemLink breadcrumbRoot">Site</a><span class="itemSeparator breadcrumbRoot">·</span><a href="../Documentation.html" class="itemLink">Documentation</a><span class="itemSeparatorDot itemSeparator">·</span><span class="itemSeparatorGreaterThan itemSeparator">&gt;</span><span class="itemSeparatorSlash itemSeparator">/</span><a href="KnowledgeBase.html" class="itemLink">Knowledge Base</a><span class="itemSeparatorDot itemSeparator">·</span><span class="itemSeparatorGreaterThan itemSeparator">&gt;</span><span class="itemSeparatorSlash itemSeparator">/</span><a href="JSR299AndWeld.html" class="itemLink">JSR-299 and Weld</a><span class="itemSeparatorDot itemSeparator">·</span><span class="itemSeparatorGreaterThan itemSeparator">&gt;</span><span class="itemSeparatorSlash itemSeparator">/</span><a href="WeldAndJPARunningInTomcat.html" class="itemText">Weld and JPA running in Tomcat</a></span>
      </div>
      <div id="messageBoxContainer"></div>
      <div id="clientMessageBoxContainer" style="display:none;"> 
       <div id="clientMessageBox" class="messageBox"> 
        <table id="clientMessageBoxTable" class="messageBoxTable" cellpadding="0" cellspacing="0" border="0"></table> 
        <script type="text/javascript">jQuery(function() {
                    jQuery("#clientMessageBoxContainer").css("margin-top", "10px").css("margin-bottom", "10px");
                    pulsate(".clientMessageBoxImage");
                });</script> 
       </div>
      </div> 
      <div id="documentDisplayContainer" class="box">
       <div id="documentDisplay" class="documentDisplay">
        <div id="j_id362"> 
         <h1 class="documentTitle"><a href="WeldAndJPARunningInTomcat.html">Weld and JPA running in Tomcat</a> </h1>
        </div>
        <p class="wikiPara"> This example implements the portable extension suggested in this <a href="http://seamframework.org/Community/HowDoIGetAJPAEntityManagerReferenceInWeld" target="" class="regularLink">discussion </a> </p> 
        <p class="wikiPara"> 1. Create a simple maven project with packaging jar by executing </p> 
        <pre class="wikiPreformatted">mvn archetype:generate</pre> 
        <p class="wikiPara"> and choosing option 15 </p> 
        <p class="wikiPara"> 2. Edit the pom.xml: </p> 
        <pre class="wikiPreformatted">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;org.seamframework.persistence&lt;/groupId&gt;
    &lt;artifactId&gt;persistence.context.extension&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;
    &lt;build&gt;
        &lt;finalName&gt;persistenceContextExtension&lt;/finalName&gt;
        &lt;plugins&gt;
            &lt;!-- Compiler plugin enforces Java 1.6 --&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;source&gt;1.6&lt;/source&gt;
                    &lt;target&gt;1.6&lt;/target&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.enterprise&lt;/groupId&gt;
            &lt;artifactId&gt;cdi-api&lt;/artifactId&gt;
            &lt;version&gt;1.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;javax.persistence&lt;/groupId&gt;
          &lt;artifactId&gt;persistence-api&lt;/artifactId&gt;
          &lt;version&gt;1.0&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;</pre> 
        <p class="wikiPara"> 3. Add the following Java class </p> 
        <pre class="wikiPreformatted">package org.seamframework.persistence;

import java.lang.annotation.Annotation;
import java.lang.reflect.Type;
import java.util.Collections;
import java.util.HashSet;
import java.util.Set;

import javax.enterprise.context.ApplicationScoped;
import javax.enterprise.context.spi.CreationalContext;
import javax.enterprise.event.Observes;
import javax.enterprise.inject.Alternative;
import javax.enterprise.inject.Any;
import javax.enterprise.inject.Default;
import javax.enterprise.inject.spi.AfterBeanDiscovery;
import javax.enterprise.inject.spi.AnnotatedField;
import javax.enterprise.inject.spi.Bean;
import javax.enterprise.inject.spi.BeanManager;
import javax.enterprise.inject.spi.BeforeBeanDiscovery;
import javax.enterprise.inject.spi.Extension;
import javax.enterprise.inject.spi.InjectionPoint;
import javax.enterprise.inject.spi.ProcessAnnotatedType;
import javax.enterprise.inject.spi.ProcessProducer;
import javax.enterprise.inject.spi.Producer;
import javax.enterprise.util.AnnotationLiteral;
import javax.inject.Qualifier;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.PersistenceContext;

/**
 * Support for managed persistence contexts in Java SE environment.
 *
 * @author Gavin King
 */
public class PersistenceContextExtension implements Extension
{

    private Bean&lt;EntityManagerFactory&gt; emfBean;

    /**
     * For @PersistenceContext producer fields, make a bean for the EMF, then
     * wrap the producer CDI creates, to get the EM from the EMF bean we made
     * instead of trying to get it from the Java EE component environment.
     */
    void processProducer(@Observes ProcessProducer&lt;?, EntityManager&gt; pp, final BeanManager bm)
    {

        if (pp.getAnnotatedMember().isAnnotationPresent(PersistenceContext.class))
        {

            if (emfBean == null)
            {
                AnnotatedField&lt;?&gt; field = (AnnotatedField&lt;?&gt;) pp.getAnnotatedMember();
                final String unitName = field.getAnnotation(PersistenceContext.class).unitName();
                final Class&lt;?&gt; module = field.getJavaMember().getDeclaringClass();
                final Set&lt;Annotation&gt; qualifiers = new HashSet&lt;Annotation&gt;();
                for (Annotation ann : field.getAnnotations())
                {
                    Class&lt;? extends Annotation&gt; annotationType = ann.annotationType();
                    //if ( bm.isQualifier(annotationType)) {
                    if (annotationType.isAnnotationPresent(Qualifier.class))
                    { //work around bug in Weld
                        qualifiers.add(ann);
                    }
                }
                if (qualifiers.isEmpty())
                {
                    qualifiers.add(new AnnotationLiteral&lt;Default&gt;()
                    {
                    });
                }
                qualifiers.add(new AnnotationLiteral&lt;Any&gt;()
                {
                });
                final boolean alternative = field.isAnnotationPresent(Alternative.class);
                final Set&lt;Type&gt; types = new HashSet&lt;Type&gt;()
                {
                    {
                        add(EntityManagerFactory.class);
                        add(Object.class);
                    } };

                //create a bean for the EMF
                emfBean = new Bean&lt;EntityManagerFactory&gt;()
                {
                    @Override
                    public Set&lt;Type&gt; getTypes()
                    {
                        return types;
                    }

                    @Override
                    public Class&lt;? extends Annotation&gt; getScope()
                    {
                        return ApplicationScoped.class;
                    }

                    @Override
                    public EntityManagerFactory create(CreationalContext&lt;EntityManagerFactory&gt; ctx)
                    {
                        return Persistence.createEntityManagerFactory(unitName);
                    }

                    @Override
                    public void destroy(EntityManagerFactory emf, CreationalContext&lt;EntityManagerFactory&gt; ctx)
                    {
                        emf.close();
                        ctx.release();
                    }

                    @Override
                    public Class&lt;?&gt; getBeanClass()
                    {
                        return module;
                    }

                    @Override
                    public Set&lt;InjectionPoint&gt; getInjectionPoints()
                    {
                        return Collections.EMPTY_SET;
                    }

                    @Override
                    public String getName()
                    {
                        return null;
                    }

                    @Override
                    public Set&lt;Annotation&gt; getQualifiers()
                    {
                        return qualifiers;
                    }

                    @Override
                    public Set&lt;Class&lt;? extends Annotation&gt;&gt; getStereotypes()
                    {
                        return Collections.EMPTY_SET; //TODO!
                    }

                    @Override
                    public boolean isAlternative()
                    {
                        return alternative;
                    }

                    @Override
                    public boolean isNullable()
                    {
                        return false;
                    }
                };

            }
            else
            {
                throw new RuntimeException("Only one EMF per application is supported");
            }

            Producer&lt;EntityManager&gt; producer = new Producer&lt;EntityManager&gt;()
            {
                @Override
                public Set&lt;InjectionPoint&gt; getInjectionPoints()
                {
                    return Collections.EMPTY_SET;
                }

                @Override
                public EntityManager produce(CreationalContext&lt;EntityManager&gt; ctx)
                {
                    return getFactory(ctx).createEntityManager();
                }

                private EntityManagerFactory getFactory(CreationalContext&lt;EntityManager&gt; ctx)
                {
                    return (EntityManagerFactory) bm.getReference(emfBean, EntityManagerFactory.class, ctx);
                }

                @Override
                public void dispose(EntityManager em)
                {
                    if (em.isOpen()) //work around what I suspect is a bug in Weld
                    {
                        em.close();
                    }
                }
            };
            pp.setProducer(producer);
        }
        
    }

    /**
     * Register the EMF bean with the container.
     */
    void afterBeanDiscovery(@Observes AfterBeanDiscovery abd)
    {
        abd.addBean(emfBean);
        System.out.println("finished the scanning process");

    }

    void beforeBeanDiscovery(@Observes BeforeBeanDiscovery bbd)
    {

        System.out.println("beginning the scanning process");

    }


    &lt;T&gt; void processAnnotatedType(@Observes ProcessAnnotatedType&lt;T&gt; pat)
    {

        System.out.println("scanning type: " + pat.getAnnotatedType().getJavaClass().getName());

    }


}
</pre> 
        <p class="wikiPara"> 4. Create a file named javax.enterprise.inject.spi.Extension in the directory /src/main/resources/META-INF/services </p> 
        <p class="wikiPara"> 5. Add the line org.seamframework.persistence.PersistenceContextExtension to the file created in 4.) </p> 
        <p class="wikiPara"> 6. Now install the artifact by calling </p> 
        <pre class="wikiPreformatted">mvn clean install</pre> 
        <p class="wikiPara"> 7. Create a webapp maven project with packaging war by executing </p> 
        <pre class="wikiPreformatted">mvn archetype:generate</pre> 
        <p class="wikiPara"> and choosing option 18 (After the project is created you have to manually add the missing directory src/main/java) </p> 
        <p class="wikiPara"> 8. Edit the pom.xml of the webapp project (since I'm working behind a restrictive firewall, we have our own maven repo here, so excuse me if some dependencies don't resolve or are not necessary): </p> 
        <pre class="wikiPreformatted">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;weldTest&lt;/groupId&gt;
    &lt;artifactId&gt;weldTest&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
    &lt;packaging&gt;war&lt;/packaging&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
            &lt;artifactId&gt;hibernate&lt;/artifactId&gt;
            &lt;version&gt;3.2.6.ga&lt;/version&gt;
        &lt;/dependency&gt;
         &lt;dependency&gt;
            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
            &lt;artifactId&gt;hibernate-annotations&lt;/artifactId&gt;
            &lt;version&gt;3.3.1.GA&lt;/version&gt;
        &lt;/dependency&gt;
         &lt;dependency&gt;
            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
            &lt;artifactId&gt;hibernate-commons-annotations&lt;/artifactId&gt;
            &lt;version&gt;3.1.0.GA&lt;/version&gt;
        &lt;/dependency&gt;
         
         &lt;dependency&gt;
            &lt;groupId&gt;cglib&lt;/groupId&gt;
            &lt;artifactId&gt;cglib-nodep&lt;/artifactId&gt;
            &lt;version&gt;2.1_3&lt;/version&gt;
        &lt;/dependency&gt;
         &lt;dependency&gt;
            &lt;groupId&gt;javax.transaction&lt;/groupId&gt;
            &lt;artifactId&gt;jta&lt;/artifactId&gt;
            &lt;version&gt;1.1&lt;/version&gt;
        &lt;/dependency&gt;
         &lt;dependency&gt;
            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
            &lt;artifactId&gt;hibernate-entitymanager&lt;/artifactId&gt;
            &lt;version&gt;3.4.0.GA&lt;/version&gt;
        &lt;/dependency&gt;
         &lt;dependency&gt;
            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
            &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
            &lt;version&gt;1.5.8&lt;/version&gt;
        &lt;/dependency&gt;
         &lt;dependency&gt;
            &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
            &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt;
            &lt;version&gt;1.5.6&lt;/version&gt;
        &lt;/dependency&gt;
         
         &lt;dependency&gt;
            &lt;groupId&gt;dom4j&lt;/groupId&gt;
            &lt;artifactId&gt;dom4j&lt;/artifactId&gt;
            &lt;version&gt;1.6.1&lt;/version&gt;
        &lt;/dependency&gt;
         &lt;dependency&gt;
            &lt;groupId&gt;commons-collections
            &lt;/groupId&gt;
            &lt;artifactId&gt;commons-collections&lt;/artifactId&gt;
            &lt;version&gt;3.2.1&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;commons-logging
            &lt;/groupId&gt;
            &lt;artifactId&gt;commons-logging&lt;/artifactId&gt;
            &lt;version&gt;1.1.1&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;log4j&lt;/groupId&gt;
            &lt;artifactId&gt;log4j&lt;/artifactId&gt;
            &lt;version&gt;1.2.14&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.hibernate&lt;/groupId&gt;
            &lt;artifactId&gt;hibernate-validator&lt;/artifactId&gt;
            &lt;version&gt;3.0.0.ga&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.enterprise&lt;/groupId&gt;
            &lt;artifactId&gt;cdi-api&lt;/artifactId&gt;
            &lt;version&gt;1.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.servlet&lt;/groupId&gt;
            &lt;artifactId&gt;jstl&lt;/artifactId&gt;
            &lt;version&gt;1.2&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.jboss.weld&lt;/groupId&gt;
            &lt;artifactId&gt;weld-api&lt;/artifactId&gt;
            &lt;version&gt;1.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.jboss.weld&lt;/groupId&gt;
            &lt;artifactId&gt;weld-core&lt;/artifactId&gt;
            &lt;version&gt;1.0.1-CR2&lt;/version&gt;
           
        &lt;/dependency&gt;
        &lt;dependency&gt;
          &lt;groupId&gt;hsqldb&lt;/groupId&gt;
          &lt;artifactId&gt;hsqldb&lt;/artifactId&gt;
          &lt;version&gt;1.8.0.5&lt;/version&gt;
        &lt;/dependency&gt;
        

        &lt;dependency&gt;
            &lt;groupId&gt;org.seamframework.persistence&lt;/groupId&gt;
            &lt;artifactId&gt;persistence.context.extension&lt;/artifactId&gt;
            &lt;version&gt;1.0&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;org.jboss.weld.servlet&lt;/groupId&gt;
            &lt;artifactId&gt;weld-servlet&lt;/artifactId&gt;
            &lt;version&gt;1.0.1-CR2&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.annotation&lt;/groupId&gt;
            &lt;artifactId&gt;jsr250-api&lt;/artifactId&gt;
            &lt;version&gt;1.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.faces&lt;/groupId&gt;
            &lt;artifactId&gt;jsf-api&lt;/artifactId&gt;
            &lt;version&gt;2.0.2-FCS&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.faces&lt;/groupId&gt;
            &lt;artifactId&gt;jsf-impl&lt;/artifactId&gt;
            &lt;version&gt;2.0.2-FCS&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.glassfish.web&lt;/groupId&gt;
            &lt;artifactId&gt;el-impl&lt;/artifactId&gt;
            &lt;version&gt;2.1.2-b04&lt;/version&gt;
            &lt;scope&gt;runtime&lt;/scope&gt;
            &lt;exclusions&gt;
                &lt;exclusion&gt;
                    &lt;groupId&gt;javax.el&lt;/groupId&gt;
                    &lt;artifactId&gt;el-api&lt;/artifactId&gt;
                &lt;/exclusion&gt;
            &lt;/exclusions&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.seamframework.persistence&lt;/groupId&gt;
            &lt;artifactId&gt;persistence.context.extension&lt;/artifactId&gt;
            &lt;version&gt;1.0&lt;/version&gt;
        &lt;/dependency&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;javax.inject&lt;/groupId&gt;
            &lt;artifactId&gt;javax.inject&lt;/artifactId&gt;
            &lt;version&gt;1&lt;/version&gt;
        &lt;/dependency&gt;

    &lt;/dependencies&gt;
    &lt;build&gt;
        &lt;finalName&gt;weldTest&lt;/finalName&gt;
        &lt;plugins&gt;
            &lt;!-- Compiler plugin enforces Java 1.6 --&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;source&gt;1.6&lt;/source&gt;
                    &lt;target&gt;1.6&lt;/target&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
                &lt;artifactId&gt;tomcat-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;1.0-beta-1&lt;/version&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;

&lt;/project&gt;</pre> 
        <p class="wikiPara"> 9. Add the file persistence.xml to directory /src/main/resources/META-INF and edit it as follows: </p> 
        <pre class="wikiPreformatted">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence xmlns="http://java.sun.com/xml/ns/persistence" version="2.0"&gt;
    &lt;persistence-unit name="foo" transaction-type="RESOURCE_LOCAL"&gt;
        &lt;provider&gt;org.hibernate.ejb.HibernatePersistence&lt;/provider&gt;
            &lt;properties&gt;
                &lt;property name="hibernate.dialect" value="org.hibernate.dialect.HSQLDialect" /&gt;
                &lt;property name="hibernate.connection.driver_class" value="org.hsqldb.jdbcDriver" /&gt;
                &lt;property name="hibernate.connection.username" value="sa" /&gt;
                &lt;property name="hibernate.connection.password" value="" /&gt;
                &lt;property name="hibernate.connection.url" value="jdbc:hsqldb:mem:todo" /&gt;
                &lt;property name="hibernate.hbm2ddl.auto" value="create" /&gt;
            &lt;/properties&gt;
        &lt;/persistence-unit&gt;
&lt;/persistence&gt;</pre> 
        <p class="wikiPara"> 10. Add the following Java class </p> 
        <pre class="wikiPreformatted">package org.seamframework.tx;

import java.io.Serializable;

import javax.enterprise.inject.Any;
import javax.inject.Inject;
import javax.interceptor.AroundInvoke;
import javax.interceptor.Interceptor;
import javax.interceptor.InvocationContext;
import javax.persistence.EntityManager;

/**
 * Declarative JPA EntityTransactions
 *
 * @author Gavin King
 */
@Transactional
@Interceptor
public class EntityTransactionInterceptor  implements Serializable
{

    private
    @Inject
    @Any
    EntityManager em;

    @AroundInvoke
    public Object aroundInvoke(InvocationContext ic) throws Exception
    {
        boolean act = !em.getTransaction().isActive();
        if (act)
        {
            em.getTransaction().begin();
        }
        try
        {
            Object result = ic.proceed();
            if (act)
            {
                em.getTransaction().commit();
            }
            return result;
        }
        catch (Exception e)
        {
            if (act)
            {
                em.getTransaction().rollback();
            }
            throw e;
        }
    }
}</pre> 
        <p class="wikiPara"> 11. Add the following Java class </p> 
        <pre class="wikiPreformatted">package org.seamframework.tx;
import static java.lang.annotation.ElementType.METHOD;
import static java.lang.annotation.ElementType.TYPE;
import static java.lang.annotation.RetentionPolicy.RUNTIME;

import java.lang.annotation.Documented;
import java.lang.annotation.Retention;
import java.lang.annotation.Target;

import javax.interceptor.InterceptorBinding;

@Retention(RUNTIME)
@Target({METHOD, TYPE})
@Documented
@InterceptorBinding
public @interface Transactional {}</pre> 
        <p class="wikiPara"> 12. Add the following Java class </p> 
        <pre class="wikiPreformatted">package weld.example;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

/**
 * User: rossmyt
 * Date: 28.01.2010
 * Time: 14:02:07
 */
@Entity
public class Book
{

    private Long id;

    private String name;
    private String author;
    @Id
    @GeneratedValue(strategy = GenerationType.SEQUENCE)
    @Column(name = "id")
    public Long getId()
    {
        return id;
    }

    public void setId(Long id)
    {
        this.id = id;
    }
    @Column(name = "name")
    public String getName()
    {
        return name;
    }

    public void setName(String name)
    {
        this.name = name;
    }
    @Column(name = "author")
    public String getAuthor()
    {
        return author;
    }

    public void setAuthor(String author)
    {
        this.author = author;
    }
}
</pre> 
        <p class="wikiPara"> 13. Add the following Java class </p> 
        <pre class="wikiPreformatted">package weld.example;

import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;

import javax.enterprise.context.SessionScoped;
import javax.inject.Inject;
import javax.inject.Named;
import javax.persistence.EntityManager;

import org.seamframework.tx.Transactional;

@Named(value = "bookFactory")

@SessionScoped

public class BookFactory implements Serializable
{
    private final String text1 = "Write your book in a sec!";
    private final String text2 = "List of written books";


    @Inject
    EntityManager em;


    private Book book = new Book();
    List&lt;Book&gt; books = new ArrayList&lt;Book&gt;();

    public String getText1()
    {
        return text1;
    }

    public void setBook(Book book)
    {
        this.book = book;
    }

    public Book getBook()
    {
        return book;
    }

    public List&lt;Book&gt; getBooks()
    {
        return books;
    }

    @SuppressWarnings({"unchecked"})
    @Transactional
    public void saveBook()
    {
        em.persist(book);
        books = em.createQuery("from Book").getResultList();
        book = new Book();
    }

    public String getText2()
    {
        return text2;  //To change body of created methods use File | Settings | File Templates.
    }
}</pre> 
        <p class="wikiPara"> 14. Add the following Java Class </p> 
        <pre class="wikiPreformatted">package weld.example;

import java.io.Serializable;

import javax.enterprise.context.ApplicationScoped;
import javax.enterprise.context.SessionScoped;
import javax.enterprise.inject.Produces;
import javax.inject.Named;
import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

/**
 * User: rossmyt
 * Date: 17.02.2010
 * Time: 16:41:35
 */
@Named(value = "init")
@ApplicationScoped
public class Init implements Serializable
{
    @Produces
    @ApplicationScoped
    @PersistenceContext(unitName = "foo")
    EntityManager em;
}
</pre> 
        <p class="wikiPara"> 15. Add the file beans.xml to directory src/main/webapp/WEB-INF and edit it as follows: </p> 
        <pre class="wikiPreformatted">&lt;beans

        xmlns="http://java.sun.com/xml/ns/javaee"

        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"

        xsi:schemaLocation="

      http://java.sun.com/xml/ns/javaee

      http://java.sun.com/xml/ns/javaee/beans_1_0.xsd"&gt;

    &lt;interceptors&gt;

        &lt;class&gt;org.seamframework.tx.EntityTransactionInterceptor&lt;/class&gt;

    &lt;/interceptors&gt;

&lt;/beans&gt;</pre> 
        <p class="wikiPara"> 16. Add the file faces-config.xml to directory src/main/webapp/WEB-INF and edit it as follows: </p> 
        <pre class="wikiPreformatted">&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;faces-config xmlns="http://java.sun.com/xml/ns/javaee"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd"
              version="2.0"&gt;
&lt;/faces-config&gt;</pre> 
        <p class="wikiPara"> 17. Edit the file web.xml indirectory src/main/webapp/WEB-INF as follows: </p> 
        <pre class="wikiPreformatted">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app version="2.5"
   xmlns="http://java.sun.com/xml/ns/javaee"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="
      http://java.sun.com/xml/ns/javaee
	  http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"&gt;

   &lt;display-name&gt;Weld Numberguess example&lt;/display-name&gt;

   &lt;context-param&gt;
      &lt;param-name&gt;javax.faces.DEFAULT_SUFFIX&lt;/param-name&gt;
      &lt;param-value&gt;.xhtml&lt;/param-value&gt;
   &lt;/context-param&gt;

   &lt;listener&gt;
      &lt;listener-class&gt;org.jboss.weld.environment.servlet.Listener&lt;/listener-class&gt;
   &lt;/listener&gt;

   &lt;servlet&gt;
      &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;
      &lt;servlet-class&gt;javax.faces.webapp.FacesServlet&lt;/servlet-class&gt;
      &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
   &lt;/servlet&gt;

   &lt;servlet-mapping&gt;
      &lt;servlet-name&gt;Faces Servlet&lt;/servlet-name&gt;
      &lt;url-pattern&gt;*.jsf&lt;/url-pattern&gt;
   &lt;/servlet-mapping&gt;

   &lt;session-config&gt;
      &lt;session-timeout&gt;10&lt;/session-timeout&gt;
   &lt;/session-config&gt;

   &lt;resource-env-ref&gt;
      &lt;description&gt;Object factory for the CDI Bean Manager&lt;/description&gt;
      &lt;resource-env-ref-name&gt;BeanManager&lt;/resource-env-ref-name&gt;
      &lt;resource-env-ref-type&gt;javax.enterprise.inject.spi.BeanManager&lt;/resource-env-ref-type&gt;
   &lt;/resource-env-ref&gt;

&lt;/web-app&gt;
</pre> 
        <p class="wikiPara"> 18. Add the file index.xhtml to directory src/main/webapp and edit it as follows: </p> 
        <pre class="wikiPreformatted">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"&gt;
&lt;h:head&gt;
    &lt;title&gt;Weld and JPA Portable Extension Demo&lt;/title&gt;
&lt;/h:head&gt;
&lt;h:body&gt;
    &lt;h1&gt;#{bookFactory.text1}&lt;/h1&gt;
    &lt;h:form&gt;
        &lt;h:panelGrid columns="2"&gt;
            &lt;p&gt;Title&lt;/p&gt;
            &lt;h:inputText value="#{bookFactory.book.name}"/&gt;

            &lt;p&gt;Author&lt;/p&gt;
            &lt;h:inputText value="#{bookFactory.book.author}"/&gt;
        &lt;/h:panelGrid&gt;
        &lt;table&gt;
            &lt;ui:fragment rendered="#{not empty bookFactory.books}"&gt;
                &lt;th&gt;&lt;h:outputText value="#{bookFactory.text2}"/&gt;
                &lt;/th&gt;
                &lt;ui:repeat var="book" value="#{bookFactory.books}"&gt;
                    &lt;tr&gt;
                        &lt;td&gt;#{book.author}&lt;/td&gt;
                        &lt;td&gt;#{book.name}&lt;/td&gt;
                    &lt;/tr&gt;
                &lt;/ui:repeat&gt;&lt;/ui:fragment&gt;
        &lt;/table&gt;
        &lt;h:commandButton action="#{bookFactory.saveBook}" value="Write it!"/&gt;
    &lt;/h:form&gt;
&lt;/h:body&gt;
&lt;/html&gt;</pre> 
        <p class="wikiPara"> 19. Now you can build and run the webapp: </p> 
        <pre class="wikiPreformatted">mvn clean package tomcat:run-war</pre> 
        <p class="wikiPara"> 20. Access the webapp at http://localhost:8080/weldTest/index.jsf . If all went well you should be able to write a book, and it should appear in the book list after writing it. </p> 
       </div>
       <div id="j_id374" class="documentCreatorHistory undecoratedLink smallFont">
        <div id="j_id375">
          Created:&nbsp;17. Feb 2010, 12:25&nbsp;America/New_York&nbsp;(Tilman Rossmy)
        </div>
        <div id="j_id383">
          Last Modified:&nbsp;17. Sep 2011, 03:19&nbsp;America/New_York&nbsp;(Shane Bryzak)
        </div>
       </div> 
      </div>
      <div id="commentDisplayForm">
       <div id="comments" class="commentsDisplay"></div>
      </div> 
     </div> 
     <div class="clear" style="padding-top:15px;"></div> 
    </div>
   </div> 
  </div> 
  <div id="footer" class="undecoratedLink"> 
   <p> © Copyright 2009, Red Hat Middleware, LLC. All rights reserved. JBoss and Seam are registered trademarks and servicemarks of <a href="http://www.redhat.com/">Red Hat, Inc</a>. [<a href="http://www.redhat.com/legal/privacy_statement.html">Privacy Policy</a>]</p> 
  </div>
  <div id="status">
   <span id="globalStatus"><span id="globalStatus.start" style="display: none">
     <div id="j_id608" class="statusStart">
      <img src="../themes/sfwkorg/img/statusindicator.gif" height="25" width="20">
     </div></span><span id="globalStatus.stop">
     <div id="j_id610" class="statusStop">
      <img src="../themes/sfwkorg/img/blank.gif" height="25" width="20">
     </div></span></span>
  </div>  
  <!-- Mirrored from 127.0.0.1:64444/Documentation/WeldAndJPARunningInTomcat by HTTrack Website Copier/3.x [XR&CO'2008], Wed, 01 Oct 2014 13:49:56 GMT --> 
  <!-- Added by HTTrack -->
  <meta http-equiv="content-type" content="text/html;charset=UTF-8">
  <!-- /Added by HTTrack --> 
 </body>
</html>